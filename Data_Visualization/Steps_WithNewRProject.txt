#Create New R Project
#Save the csv files in the project working directory
library(readr)
library(ggplot2)
library(tm)
library(SnowballC)
library(wordcloud)
# If packages Not available, please download using:  install.packages('package_name') ::for example install.packages('tm')

PositiveFeatures <- read_csv("PositiveFeatures.csv", col_names = FALSE) #Modify if files in another directory
NegativeFeatures <- read_csv("NegativeFeatures.csv", col_names = FALSE)
NeutralFeatures <- read_csv("NeutralFeatures.csv", col_names = FALSE)
Sentiment<- read_csv("Sentiment.csv", col_names = FALSE)


### Sentiment ###
sentimentData<-data.frame(SentimentClass=Sentiment$X1,TweetCount=Sentiment$X2)
sentimentData $ SentimentClass <- factor(sentimentData $ SentimentClass, levels = sentimentData $ SentimentClass)
ggplot(sentimentData, aes(x= SentimentClass, y= TweetCount)) + geom_bar(stat="identity")

ggplot(sentimentData, aes(x= SentimentClass, y= TweetCount)) +geom_bar(stat="identity",fill="blue", colour="black")


### Positive : Top 10 keywords and WordCloud ###
positives <- Corpus(VectorSource(PositiveFeatures$X1))
positives <- tm_map(positives, PlainTextDocument)
positives <- tm_map(positives, removePunctuation)
positives <- tm_map(positives, removeWords, stopwords('english'))
positives <- tm_map(positives, stemDocument)
#Black and white word cloud
#wordcloud(positives, max.words = 25, random.order = FALSE)
#Colored Word Cloud
dtmPositive <- TermDocumentMatrix(positives)
mPositive <- as.matrix(dtmPositive)
vPositive <- sort(rowSums(mPositive),decreasing=TRUE)
dPositive <- data.frame(word = names(vPositive),freq=vPositive)
head(dPositive, 10)  # Prints List of top 10 Positive Features
set.seed(1234)
wordcloud(words = dPositive$word, freq = dPositive$freq, min.freq = 1,max.words=50, random.order=FALSE, rot.per=0.35, colors=brewer.pal(8, "Dark2"))

### Negative : Top 10 keywords and WordCloud ###
negatives <- Corpus(VectorSource(NegativeFeatures$X1))
negatives <- tm_map(negatives, PlainTextDocument)
negatives <- tm_map(negatives, removePunctuation)
negatives <- tm_map(negatives, removeWords, stopwords('english'))
negatives <- tm_map(negatives, stemDocument)
#Black and white word cloud
#wordcloud(negatives, max.words = 25, random.order = FALSE)
#Colored Word Cloud
dtmNegative <- TermDocumentMatrix(negatives)
mNegative <- as.matrix(dtmNegative)
vNegative <- sort(rowSums(mNegative),decreasing=TRUE)
dNegative <- data.frame(word = names(vNegative),freq=vNegative)
head(dNegative, 10)  # Prints List of top 10 Negative Features
set.seed(1234)
wordcloud(words = dNegative$word, freq = dNegative$freq, min.freq = 1,max.words=50, random.order=FALSE, rot.per=0.35, colors=brewer.pal(8, "Dark2"))


### Timelines###
PosMonths <- read_csv("PosMonths.csv", col_names = FALSE)
NegMonths <- read_csv("NegMonths.csv", col_names = FALSE)
NeutralMonths <- read_csv("NeutralMonths.csv", col_names = FALSE)
posMonthsTest<-data.frame(Month=PosMonths$X2,Count=PosMonths$X1)
negMonthsTest<-data.frame(Month=NegMonths$X2,Count=NegMonths$X1)
neutralMonthsTest<-data.frame(Month=NeutralMonths$X2,Count=NeutralMonths$X1)
posMonthsTest $Month <- factor(posMonthsTest $Month, levels = posMonthsTest $Month)
negMonthsTest $Month <- factor(negMonthsTest $Month, levels = negMonthsTest $Month)
neutralMonthsTest $Month <- factor(neutralMonthsTest $Month, levels = neutralMonthsTest $Month)


ggplot(posMonthsTest, aes(x=Month, y=Count)) +geom_bar(stat="identity",fill="blue", colour="black")
ggplot(negMonthsTest, aes(x=Month, y=Count)) +geom_bar(stat="identity",fill="blue", colour="black")
ggplot(neutralMonthsTest, aes(x=Month, y=Count)) +geom_bar(stat="identity",fill="blue", colour="black")

### Neutral : Top 10 keywords and WordCloud ###
neutrals <- Corpus(VectorSource(NeutralFeatures$X1))
neutrals <- tm_map(neutrals, PlainTextDocument)
neutrals <- tm_map(neutrals, removePunctuation)
neutrals <- tm_map(neutrals, removeWords, stopwords('english'))
neutrals <- tm_map(neutrals, stemDocument)
#Black and white word cloud
#wordcloud(neutrals, max.words = 25, random.order = FALSE)
#Colored Word Cloud
dtmNeutral <- TermDocumentMatrix(neutrals)
mNeutral <- as.matrix(dtmNeutral)
vNeutral <- sort(rowSums(mNeutral),decreasing=TRUE)
dNeutral <- data.frame(word = names(vNeutral),freq=vNeutral)
head(dNeutral, 10)  # Prints List of top 10 Neutral Features
set.seed(1234)
wordcloud(words = dNeutral$word, freq = dNeutral$freq, min.freq = 1,max.words=50, random.order=FALSE, rot.per=0.35, colors=brewer.pal(8, "Dark2"))

